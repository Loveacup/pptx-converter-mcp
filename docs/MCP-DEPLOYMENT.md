# MCP æœåŠ¡å™¨éƒ¨ç½²å®Œæˆ âœ…

## éƒ¨ç½²çŠ¶æ€

### ğŸ“¦ å·²éƒ¨ç½²ç»„ä»¶

#### 1. MCP æœåŠ¡å™¨: `pptx-converter`
**è·¯å¾„**: `~/.local/bin/pptx-converter-mcp`
**é…ç½®**: `~/.mcp.json`

**åŠŸèƒ½**:
- âœ… `convert_single_pptx` - å•äºº PPT è½¬æ¢ï¼ˆå¸¦å›¾ç‰‡æè¿°ï¼‰
- âœ… `convert_batch_pptx` - æ‰¹é‡ PPT è½¬æ¢ï¼ˆå¸¦å›¾ç‰‡æè¿°ï¼‰

#### 2. åº•å±‚å·¥å…·
| å·¥å…· | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| `pptx-to-md` | `~/.local/bin/pptx-to-md` | å•äººè½¬æ¢ |
| `pptx-batch-convert` | `~/.local/bin/pptx-batch-convert` | æ‰¹é‡è½¬æ¢ |
| `pptx-converter-mcp` | `~/.local/bin/pptx-converter-mcp` | MCP æœåŠ¡å™¨ |

#### 3. é…ç½®æ›´æ–°
**æ–‡ä»¶**: `~/.mcp.json`

**å·²ç§»é™¤**:
- âŒ åŸæœ‰çš„ `markitdown` MCPï¼ˆåŠŸèƒ½æœ‰é™ï¼‰

**å·²æ·»åŠ **:
- âœ… æ–°çš„ `pptx-converter` MCPï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰

---

## é…ç½®è¯¦æƒ…

```json
{
  "mcpServers": {
    "pptx-converter": {
      "command": "/opt/homebrew/bin/python3.11",
      "args": ["/Users/alexcai/.local/bin/pptx-converter-mcp"],
      "env": {
        "LLM_API_URL": "http://172.16.27.10:9998/v1/chat/completions",
        "LLM_MODEL": "Qwen3-VL-32B",
        "MAX_WORKERS": "3",
        "CACHE_DIR": "/tmp/ppt_image_cache"
      }
    }
  }
}
```

---

## å¯ç”¨å·¥å…·

### å·¥å…· 1: convert_single_pptx
**æè¿°**: å°†å•ä¸ª PPT æ–‡ä»¶è½¬æ¢ä¸º Markdownï¼ŒåŒ…å« AI å›¾ç‰‡æè¿°

**å‚æ•°**:
- `input_path` (required): PPT æ–‡ä»¶çš„å®Œæ•´è·¯å¾„
- `output_path` (optional): è¾“å‡º Markdown æ–‡ä»¶è·¯å¾„

**ç¤ºä¾‹**:
```json
{
  "input_path": "/path/to/presentation.pptx",
  "output_path": "/path/to/output.md"
}
```

### å·¥å…· 2: convert_batch_pptx
**æè¿°**: æ‰¹é‡è½¬æ¢ç›®å½•ä¸­çš„æ‰€æœ‰ PPT æ–‡ä»¶ä¸º Markdown

**å‚æ•°**:
- `input_dir` (required): åŒ…å« PPT æ–‡ä»¶çš„ç›®å½•è·¯å¾„
- `output_dir` (optional): è¾“å‡ºç›®å½•è·¯å¾„

**ç¤ºä¾‹**:
```json
{
  "input_dir": "/path/to/ppt/folder",
  "output_dir": "/path/to/output/folder"
}
```

---

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1: MCP å®¢æˆ·ç«¯ï¼ˆå¦‚ Claude Codeï¼‰
å½“ MCP å®¢æˆ·ç«¯å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨è¯»å– `~/.mcp.json` é…ç½®ï¼Œæ‚¨å¯ä»¥ç›´æ¥è°ƒç”¨ï¼š

```
è¯·å¸®æˆ‘å°† /path/to/file.pptx è½¬æ¢ä¸º Markdown
```

æˆ–æ‰¹é‡è½¬æ¢ï¼š
```
è¯·æ‰¹é‡è½¬æ¢ /path/to/ppt/folder ä¸­çš„æ‰€æœ‰ PPT æ–‡ä»¶
```

### æ–¹å¼ 2: å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¤‡ç”¨ï¼‰
å¦‚æœ MCP å®¢æˆ·ç«¯ä¸å¯ç”¨ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨åº•å±‚å·¥å…·ï¼š

```bash
# å•äººè½¬æ¢
~/.local/bin/pptx-to-md "input.pptx" "output.md"

# æ‰¹é‡è½¬æ¢
~/.local/bin/pptx-batch-convert "/path/to/ppt/folder"
```

---

## åŠŸèƒ½ç‰¹æ€§

### âœ… æ ¸å¿ƒåŠŸèƒ½
1. **è‡ªåŠ¨æå–å›¾ç‰‡** - ä» PPT ä¸­æå–æ‰€æœ‰å›¾ç‰‡ï¼ˆPNG/JPG/JPEG/GIF/BMP/WebPï¼‰
2. **AI å›¾ç‰‡æè¿°** - ä½¿ç”¨æœ¬åœ° Qwen3-VL-32B æ¨¡å‹ç”Ÿæˆè¯¦ç»†æè¿°
3. **å¤šçº¿ç¨‹å¤„ç†** - é»˜è®¤ 3 å¹¶å‘ï¼Œæé«˜å¤„ç†é€Ÿåº¦
4. **æ™ºèƒ½ç¼“å­˜** - é¿å…é‡å¤å¤„ç†ç›¸åŒå›¾ç‰‡
5. **Markdown æ•´åˆ** - å°†æè¿°è‡ªåŠ¨æ·»åŠ åˆ°å¯¹åº”å›¾ç‰‡ä¸‹æ–¹

### ğŸ“Š æ€§èƒ½æŒ‡æ ‡
- å•å¼ å›¾ç‰‡å¤„ç†æ—¶é—´: ~3-5 ç§’
- å¹¶å‘æ•°: 3ï¼ˆå¯è°ƒèŠ‚ï¼‰
- æ”¯æŒæ ¼å¼: PPTX
- ç¼“å­˜ä½ç½®: `/tmp/ppt_image_cache/`

---

## ç¯å¢ƒè¦æ±‚

- Python 3.11+
- MCP SDK (`pip install mcp`)
- requests
- markitdown
- æœ¬åœ° LLM API (Qwen3-VL-32B at `http://172.16.27.10:9998/v1`)

---

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: MCP æœåŠ¡å™¨æ— æ³•å¯åŠ¨
**æ£€æŸ¥**:
```bash
# æµ‹è¯• MCP æœåŠ¡å™¨è„šæœ¬
/opt/homebrew/bin/python3.11 /Users/alexcai/.local/bin/pptx-converter-mcp --help

# æ£€æŸ¥ä¾èµ–
/opt/homebrew/bin/python3.11 -c "from mcp.server import Server; print('OK')"
```

### é—®é¢˜ 2: å·¥å…·å‘½ä»¤æ‰¾ä¸åˆ°
**è§£å†³**:
```bash
export PATH="$HOME/.local/bin:$PATH"
```

### é—®é¢˜ 3: LLM API è¿æ¥å¤±è´¥
**æ£€æŸ¥**:
```bash
curl http://172.16.27.10:9998/v1/models
```

---

## æ›´æ–°æ—¥å¿—

### v1.0 (2024-02-07)
- âœ… éƒ¨ç½²è‡ªå®šä¹‰ MCP æœåŠ¡å™¨
- âœ… æ•´åˆå•äºº/æ‰¹é‡è½¬æ¢åŠŸèƒ½
- âœ… ä½¿ç”¨æœ¬åœ° Qwen3-VL-32B æ¨¡å‹
- âœ… ç§»é™¤åŸæœ‰åŠŸèƒ½å—é™çš„ markitdown MCP
- âœ… æ”¯æŒå›¾ç‰‡æè¿°ç”Ÿæˆ

---

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MCP Client                    â”‚
â”‚    (Claude Code / Other Clients)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ JSON-RPC
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       pptx-converter-mcp                â”‚
â”‚    ~/.local/bin/pptx-converter-mcp      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ subprocess
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pptx-to-md  â”‚  pptx-batch-convert       â”‚
â”‚  (å•äººè½¬æ¢)   â”‚  (æ‰¹é‡è½¬æ¢)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Local LLM API (Qwen3-VL-32B)           â”‚
â”‚  http://172.16.27.10:9998/v1            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**éƒ¨ç½²å®Œæˆï¼MCP æœåŠ¡å™¨å·²å‡†å¤‡å¥½æ¥å—è¯·æ±‚ã€‚** ğŸ‰
